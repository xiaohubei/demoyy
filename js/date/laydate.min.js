/**
 
 @Name : layDate v1.1 日期控件
 @Author: 贤心
 @Date: 2014-06-25
 @Site：http://www.sucaijiayuan.com
 
 */(function(k){var a={},h=document,f="laydate_box laydate_void laydate_click LayDateSkin skins/ /laydate.css".split(" ");k.laydate=function(b){b=b||{};try{k.event=k.event||laydate.caller.arguments[0]}catch(d){}return k.event&&(b.tagName=1),a.run(b),laydate};laydate.v="1.1";a.getPath=function(){var a=document.scripts,a=a[a.length-1].src;return a.substring(0,a.lastIndexOf("/")+1)}();a.use=function(b,d){var c=h.createElement("link");c.type="text/css";c.rel="stylesheet";c.href=a.getPath+b+f[5];d&&(c.id=d);h.getElementsByTagName("head")[0].appendChild(c)};a.trim=function(a){return a=a||"",a.replace(/^\s|\s$/g,"").replace(/\s+/g," ")};a.digit=function(a){return 10>a?"0"+(0|a):a};a.stopmp=function(a){return a=a||k.event,a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,this};a.each=function(a,d){for(var c=0,e=a.length;e>c&&!1!==d(c,a[c]);c++);};a.hasClass=function(a,d){return a=a||{},(new RegExp("\\b"+d+"\\b")).test(a.className)};a.addClass=function(b,d){return b=b||{},a.hasClass(b,d)||(b.className+=" "+d),b.className=a.trim(b.className),this};a.removeClass=function(b,d){if(b=b||{},a.hasClass(b,d))b.className=b.className.replace(new RegExp("\\b"+d+"\\b"),"");return this};a.removeCssAttr=function(a,d){var c=a.style;c.removeProperty?c.removeProperty(d):c.removeAttribute(d)};a.shde=function(a,d){a.style.display=d?"none":"block"};a.query=function(b){var d,c,e,f,l;return b=a.trim(b).split(" "),c=h.getElementById(b[0].substr(1)),c?b[1]?/^\./.test(b[1])?(f=b[1].substr(1),l=new RegExp("\\b"+f+"\\b"),d=[],e=h.getElementsByClassName?c.getElementsByClassName(f):c.getElementsByTagName("*"),a.each(e,function(a,b){l.test(b.className)&&d.push(b)}),d[0]?d:""):(d=c.getElementsByTagName(b[1]),d[0]?c.getElementsByTagName(b[1]):""):c:void 0};a.on=function(b,d,c){return b.attachEvent?b.attachEvent("on"+d,function(){c.call(b,k.even)}):b.addEventListener(d,c,!1),a};a.stopMosup=function(b,d){"mouseup"!==b&&a.on(d,"mouseup",function(b){a.stopmp(b)})};a.run=function(b){var d,c,e=a.query;if(b.tagName){if(d=b.elem?e(b.elem):event.target||event.srcElement,d&&d!==a.elem)a.view(d,b),a.stopMosup(event.type,d),a.reshow()}else if(d=e(b.elem),d)c=b.event||"click",a.each(0<(0|d.length)?d:[d],function(d,e){a.on(e,c,function(c){a.stopmp(c);e!==a.elem&&(a.view(e,b),a.reshow())});a.stopMosup(c,e)})};a.scroll=function(a){return a=a?"scrollLeft":"scrollTop",h.body[a]|h.documentElement[a]};a.winarea=function(a){return document.documentElement[a?"clientWidth":"clientHeight"]};a.isleap=function(a){return 0===a%4&&0!==a%100||0===a%400};a.checkVoid=function(b,d,c){var e=[];return b|=0,d|=0,c|=0,b<a.mins[0]?e=["y"]:b>a.maxs[0]?e=["y",1]:b>=a.mins[0]&&b<=a.maxs[0]&&(b==a.mins[0]&&(d<a.mins[1]?e=["m"]:d==a.mins[1]&&c<a.mins[2]&&(e=["d"])),b==a.maxs[0]&&(d>a.maxs[1]?e=["m",1]:d==a.maxs[1]&&c>a.maxs[2]&&(e=["d",1]))),e};a.timeVoid=function(b,d){if(a.ymd[1]+1==a.mins[1]&&a.ymd[2]==a.mins[2]){if(0===d&&b<a.mins[3]||1===d&&b<a.mins[4]||2===d&&b<a.mins[5])return 1}else if(a.ymd[1]+1==a.maxs[1]&&a.ymd[2]==a.maxs[2]&&(0===d&&b>a.maxs[3]||1===d&&b>a.maxs[4]||2===d&&b>a.maxs[5]))return 1;return b>(d?59:23)?1:void 0};a.check=function(){var b=a.options.format.replace(/YYYY|MM|DD|hh|mm|ss/g,"\\d+\\").replace(/\\$/g,""),b=new RegExp(b),d=a.elem[f.elemv],c=d.match(/\d+/g)||[],e=a.checkVoid(c[0],c[1],c[2]);if(""!==d.replace(/\s/g,"")){if(!b.test(d))return a.elem[f.elemv]="",a.msg("\u65e5\u671f\u4e0d\u7b26\u5408\u683c\u5f0f\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u3002"),1;if(e[0])return a.elem[f.elemv]="",a.msg("\u65e5\u671f\u4e0d\u5728\u6709\u6548\u671f\u5185\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u3002"),1;e.value=a.elem[f.elemv].match(b).join();c=e.value.match(/\d+/g);1>c[1]?(c[1]=1,e.auto=1):12<c[1]?(c[1]=12,e.auto=1):2>c[1].length&&(e.auto=1);1>c[2]?(c[2]=1,e.auto=1):c[2]>a.months[(0|c[1])-1]?(c[2]=31,e.auto=1):2>c[2].length&&(e.auto=1);3<c.length&&(a.timeVoid(c[3],0)&&(e.auto=1),a.timeVoid(c[4],1)&&(e.auto=1),a.timeVoid(c[5],2)&&(e.auto=1));e.auto?a.creation([c[0],0|c[1],0|c[2]],1):e.value!==a.elem[f.elemv]&&(a.elem[f.elemv]=e.value)}};a.months=[31,null,31,30,31,30,31,31,30,31,30,31];a.viewDate=function(b,d,c){var e=(a.query,{}),g=new Date;b<(0|a.mins[0])&&(b=0|a.mins[0]);b>(0|a.maxs[0])&&(b=0|a.maxs[0]);g.setFullYear(b,d,c);e.ymd=[g.getFullYear(),g.getMonth(),g.getDate()];a.months[1]=a.isleap(e.ymd[0])?29:28;g.setFullYear(e.ymd[0],e.ymd[1],1);e.FDay=g.getDay();e.PDay=a.months[0===d?11:d-1]-e.FDay+1;e.NDay=1;a.each(f.tds,function(c,b){var d,g=e.ymd[0],h=e.ymd[1]+1;b.className="";c<e.FDay?(b.innerHTML=d=c+e.PDay,a.addClass(b,"laydate_nothis"),1===h&&--g,h=1===h?12:h-1):c>=e.FDay&&c<e.FDay+a.months[e.ymd[1]]?(b.innerHTML=d=c-e.FDay+1,c-e.FDay+1===e.ymd[2]&&(a.addClass(b,f[2]),e.thisDay=b)):(b.innerHTML=d=e.NDay++,a.addClass(b,"laydate_nothis"),12===h&&(g+=1),h=12===h?1:h+1);a.checkVoid(g,h,d)[0]&&a.addClass(b,f[1]);a.options.festival&&a.festival(b,h+"."+d);b.setAttribute("y",g);b.setAttribute("m",h);b.setAttribute("d",d)});a.valid=!a.hasClass(e.thisDay,f[1]);a.ymd=e.ymd;f.year.value=a.ymd[0]+"\u5e74";f.month.value=a.digit(a.ymd[1]+1)+"\u6708";a.each(f.mms,function(b,c){var d=a.checkVoid(a.ymd[0],(0|c.getAttribute("m"))+1);"y"===d[0]||"m"===d[0]?a.addClass(c,f[1]):a.removeClass(c,f[1]);a.removeClass(c,f[2])});a.addClass(f.mms[a.ymd[1]],f[2]);e.times=[0|a.inymd[3]||0,0|a.inymd[4]||0,0|a.inymd[5]||0];a.each(Array(3),function(c){a.hmsin[c].value=a.digit(a.timeVoid(e.times[c],c)?0|a.mins[c+3]:0|e.times[c])});a[a.valid?"removeClass":"addClass"](f.ok,f[1])};a.festival=function(a,d){var c;switch(d){case "1.1":c="\u5143\u65e6";break;case "3.8":c="\u5987\u5973";break;case "4.5":c="\u6e05\u660e";break;case "5.1":c="\u52b3\u52a8";break;case "6.1":c="\u513f\u7ae5";break;case "9.10":c="\u6559\u5e08";break;case "10.1":c="\u56fd\u5e86"}c&&(a.innerHTML=c)};a.viewYears=function(b){var d=a.query,c="";a.each(Array(7),function(a){c+=7===a?"\x3cli "+(parseInt(f.year.value)===b?'class\x3d"'+f[2]+'"':"")+' y\x3d"'+b+'"\x3e'+b+"\u5e74\x3c/li\x3e":'\x3cli y\x3d"'+(b-7+a)+'"\x3e'+(b-7+a)+"\u5e74\x3c/li\x3e"});d("#laydate_ys").innerHTML=c;a.each(d("#laydate_ys li"),function(c,b){"y"===a.checkVoid(b.getAttribute("y"))[0]?a.addClass(b,f[1]):a.on(b,"click",function(c){a.stopmp(c).reshow();a.viewDate(0|this.getAttribute("y"),a.ymd[1],a.ymd[2])})})};a.initDate=function(){var b=(a.query,new Date),d=a.elem[f.elemv].match(/\d+/g)||[];3>d.length&&(d=a.options.start.match(/\d+/g)||[],3>d.length&&(d=[b.getFullYear(),b.getMonth()+1,b.getDate()]));a.inymd=d;a.viewDate(d[0],d[1]-1,d[2])};a.iswrite=function(){var b=a.query,b=b("#laydate_hms");a.shde(b,!a.options.istime);a.shde(f.oclear,!("isclear"in a.options?a.options.isclear:1));a.shde(f.otoday,!("istoday"in a.options?a.options.istoday:1));a.shde(f.ok,!("issure"in a.options?a.options.issure:1))};a.orien=function(b,d){var c;c=a.elem.getBoundingClientRect();b.style.left=c.left+(d?0:a.scroll(1))+"px";c=c.bottom+b.offsetHeight/1.5<=a.winarea()?c.bottom-1:c.top>b.offsetHeight/1.5?c.top-b.offsetHeight+1:a.winarea()-b.offsetHeight;b.style.top=c+(d?0:a.scroll())+"px"};a.follow=function(b){a.options.fixed?(b.style.position="fixed",a.orien(b,1)):(b.style.position="absolute",a.orien(b))};a.viewtb=function(){var b,d=[],c="\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split(""),e={},f=h.createElement("table"),l=h.createElement("thead");return l.appendChild(h.createElement("tr")),e.creath=function(a){var b=h.createElement("th");b.innerHTML=c[a];l.getElementsByTagName("tr")[0].appendChild(b)},a.each(Array(6),function(c){d.push([]);b=f.insertRow(0);a.each(Array(7),function(a){d[c][a]=0;0===c&&e.creath(a);b.insertCell(a)})}),f.insertBefore(l,f.children[0]),f.id=f.className="laydate_table",b=d=null,f.outerHTML.toLowerCase()}();a.view=function(b,d){var c,e=a.query,g;d=d||b;a.elem=b;a.options=d;a.options.format||(a.options.format="YYYY-MM-DD");a.options.start=a.options.start||"";a.mm=g=[a.options.min||"1900-01-01 00:00:00",a.options.max||"2099-12-31 23:59:59"];a.mins=g[0].match(/\d+/g);a.maxs=g[1].match(/\d+/g);f.elemv=/textarea|input/.test(a.elem.tagName.toLocaleLowerCase())?"value":"innerHTML";a.box?a.shde(a.box):(c=h.createElement("div"),c.id=f[0],c.className=f[0],c.style.cssText="position: absolute;",c.setAttribute("name","laydate-v"+laydate.v),c.innerHTML='\x3cdiv class\x3d"laydate_top"\x3e\x3cdiv class\x3d"laydate_ym laydate_y" id\x3d"laydate_YY"\x3e\x3ca class\x3d"laydate_choose laydate_chprev laydate_tab"\x3e\x3ccite\x3e\x3c/cite\x3e\x3c/a\x3e\x3cinput id\x3d"laydate_y" readonly\x3e\x3clabel\x3e\x3c/label\x3e\x3ca class\x3d"laydate_choose laydate_chnext laydate_tab"\x3e\x3ccite\x3e\x3c/cite\x3e\x3c/a\x3e\x3cdiv class\x3d"laydate_yms"\x3e\x3ca class\x3d"laydate_tab laydate_chtop"\x3e\x3ccite\x3e\x3c/cite\x3e\x3c/a\x3e\x3cul id\x3d"laydate_ys"\x3e\x3c/ul\x3e\x3ca class\x3d"laydate_tab laydate_chdown"\x3e\x3ccite\x3e\x3c/cite\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"laydate_ym laydate_m" id\x3d"laydate_MM"\x3e\x3ca class\x3d"laydate_choose laydate_chprev laydate_tab"\x3e\x3ccite\x3e\x3c/cite\x3e\x3c/a\x3e\x3cinput id\x3d"laydate_m" readonly\x3e\x3clabel\x3e\x3c/label\x3e\x3ca class\x3d"laydate_choose laydate_chnext laydate_tab"\x3e\x3ccite\x3e\x3c/cite\x3e\x3c/a\x3e\x3cdiv class\x3d"laydate_yms" id\x3d"laydate_ms"\x3e'+function(){var c="";return a.each(Array(12),function(b){c+='\x3cspan m\x3d"'+b+'"\x3e'+a.digit(b+1)+"\u6708\x3c/span\x3e"}),c}()+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"+a.viewtb+'\x3cdiv class\x3d"laydate_bottom"\x3e\x3cul id\x3d"laydate_hms"\x3e\x3cli class\x3d"laydate_sj"\x3e\u65f6\u95f4\x3c/li\x3e\x3cli\x3e\x3cinput readonly\x3e:\x3c/li\x3e\x3cli\x3e\x3cinput readonly\x3e:\x3c/li\x3e\x3cli\x3e\x3cinput readonly\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d"laydate_time" id\x3d"laydate_time"\x3e\x3c/div\x3e\x3cdiv class\x3d"laydate_btn"\x3e\x3ca id\x3d"laydate_clear"\x3e\u6e05\u7a7a\x3c/a\x3e\x3ca id\x3d"laydate_today"\x3e\u4eca\u5929\x3c/a\x3e\x3ca id\x3d"laydate_ok"\x3e\u786e\u8ba4\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e',h.body.appendChild(c),a.box=e("#"+f[0]),a.events(),c=null);a.follow(a.box);d.zIndex?a.box.style.zIndex=d.zIndex:a.removeCssAttr(a.box,"z-index");a.stopMosup("click",a.box);a.initDate();a.iswrite();a.check()};a.reshow=function(){return a.each(a.query("#"+f[0]+" .laydate_show"),function(b,d){a.removeClass(d,"laydate_show")}),this};a.close=function(){a.reshow();a.shde(a.query("#"+f[0]),1);a.elem=null};a.parse=function(b,d,c){return b=b.concat(d),c=c||(a.options?a.options.format:"YYYY-MM-DD"),c.replace(/YYYY|MM|DD|hh|mm|ss/g,function(){return b.index=0|++b.index,a.digit(b[b.index])})};a.creation=function(b,d){var c=(a.query,a.hmsin),c=a.parse(b,[c[0].value,c[1].value,c[2].value]);a.elem[f.elemv]=c;d||(a.close(),"function"==typeof a.options.choose&&a.options.choose(c))};a.events=function(){var b=a.query,d={box:"#"+f[0]};a.addClass(h.body,"laydate_body");f.tds=b("#laydate_table td");f.mms=b("#laydate_ms span");f.year=b("#laydate_y");f.month=b("#laydate_m");a.each(b(d.box+" .laydate_ym"),function(c,b){a.on(b,"click",function(b){a.stopmp(b).reshow();a.addClass(this.getElementsByTagName("div")[0],"laydate_show");c||(d.YY=parseInt(f.year.value),a.viewYears(d.YY))})});a.on(b(d.box),"click",function(){a.reshow()});d.tabYear=function(c){0===c?a.ymd[0]--:1===c?a.ymd[0]++:2===c?d.YY-=7:d.YY+=7;2>c?(a.viewDate(a.ymd[0],a.ymd[1],a.ymd[2]),a.reshow()):a.viewYears(d.YY)};a.each(b("#laydate_YY .laydate_tab"),function(c,b){a.on(b,"click",function(b){a.stopmp(b);d.tabYear(c)})});d.tabMonth=function(c){c?(a.ymd[1]++,12===a.ymd[1]&&(a.ymd[0]++,a.ymd[1]=0)):(a.ymd[1]--,-1===a.ymd[1]&&(a.ymd[0]--,a.ymd[1]=11));a.viewDate(a.ymd[0],a.ymd[1],a.ymd[2])};a.each(b("#laydate_MM .laydate_tab"),function(c,b){a.on(b,"click",function(b){a.stopmp(b).reshow();d.tabMonth(c)})});a.each(b("#laydate_ms span"),function(b,d){a.on(d,"click",function(b){a.stopmp(b).reshow();a.hasClass(this,f[1])||a.viewDate(a.ymd[0],0|this.getAttribute("m"),a.ymd[2])})});a.each(b("#laydate_table td"),function(b,d){a.on(d,"click",function(b){a.hasClass(this,f[1])||(a.stopmp(b),a.creation([0|this.getAttribute("y"),0|this.getAttribute("m"),0|this.getAttribute("d")]))})});f.oclear=b("#laydate_clear");a.on(f.oclear,"click",function(){a.elem[f.elemv]="";a.close()});f.otoday=b("#laydate_today");a.on(f.otoday,"click",function(){a.elem[f.elemv]=laydate.now(0,a.options.format);a.close()});f.ok=b("#laydate_ok");a.on(f.ok,"click",function(){a.valid&&a.creation([a.ymd[0],a.ymd[1]+1,a.ymd[2]])});d.times=b("#laydate_time");a.hmsin=d.hmsin=b("#laydate_hms input");d.hmss=["\u5c0f\u65f6","\u5206\u949f","\u79d2\u6570"];d.hmsarr=[];a.msg=function(c,e){var g='\x3cdiv class\x3d"laydte_hsmtex"\x3e'+(e||"\u63d0\u793a")+"\x3cspan\x3e\u00d7\x3c/span\x3e\x3c/div\x3e";"string"==typeof c?(g+="\x3cp\x3e"+c+"\x3c/p\x3e",a.shde(b("#"+f[0])),a.removeClass(d.times,"laydate_time1").addClass(d.times,"laydate_msg")):(d.hmsarr[c]?g=d.hmsarr[c]:(g+='\x3cdiv id\x3d"laydate_hmsno" class\x3d"laydate_hmsno"\x3e',a.each(Array(0===c?24:60),function(a){g+="\x3cspan\x3e"+a+"\x3c/span\x3e"}),g+="\x3c/div\x3e",d.hmsarr[c]=g),a.removeClass(d.times,"laydate_msg"),a[0===c?"removeClass":"addClass"](d.times,"laydate_time1"));a.addClass(d.times,"laydate_show");d.times.innerHTML=g};d.hmson=function(c,d){var g=b("#laydate_hmsno span"),h=a.valid?null:1;a.each(g,function(b,g){h?a.addClass(g,f[1]):a.timeVoid(b,d)?a.addClass(g,f[1]):a.on(g,"click",function(){a.hasClass(this,f[1])||(c.value=a.digit(0|this.innerHTML))})});a.addClass(g[0|c.value],"laydate_click")};a.each(d.hmsin,function(b,e){a.on(e,"click",function(e){a.stopmp(e).reshow();a.msg(b,d.hmss[b]);d.hmson(this,b)})});a.on(h,"mouseup",function(){var c=b("#"+f[0]);c&&"none"!==c.style.display&&(a.check()||a.close())}).on(h,"keydown",function(b){b=b||k.event;13===b.keyCode&&a.creation([a.ymd[0],a.ymd[1]+1,a.ymd[2]])})};a.use("need");a.use(f[4]+"default",f[3]);a.skinLink=a.query("#"+f[3]);a.init=void 0;laydate.reset=function(){a.box&&a.elem&&a.follow(a.box)};laydate.now=function(b,d){var c=Date,e;0|b?(e=parseInt(b),e=864E5>e?+new Date+864E5*e:e):e=+new Date;c=new c(e);return a.parse([c.getFullYear(),c.getMonth()+1,c.getDate()],[c.getHours(),c.getMinutes(),c.getSeconds()],d)};laydate.skin=function(b){a.skinLink.href=a.getPath+f[4]+b+f[5]}})(window);